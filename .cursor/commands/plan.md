# /plan コマンド

## 目的
Phase 2: Plan — 技術的なアーキテクチャと実装アプローチを計画します。

## 前提条件
- `specs/<ticket-id>-<slug>/spec.md` が作成済みであること
- 仕様の曖昧さが解消されていること

## 実行内容
1. システムへの影響範囲を分析（変更ファイル、依存関係）
2. 技術的なアプローチを複数案（Best-of-N）提示
3. 各案の長所・短所・リスクを比較
4. 推奨する実装方針を明確に選定
5. プロジェクトルール（`.cursor/rules/`）との整合性を確認

## 成果物
`specs/<ticket-id>-<slug>/plan.md` を以下の構造で作成してください：

```markdown
# [チケットID] 技術計画

## ゴール
- このタスクで実現する最終アウトカム

## 制約・前提
- 技術的な制約や既存仕様
- 影響範囲となるモジュール・ファイル
  - 変更予定: `src/app/.../page.tsx`, `src/actions/...`
  - 新規追加: `src/app/.../components/...`

## 技術アプローチ (Best-of-N)

### 案 A: [アプローチ名]
- **概要**: 簡潔な説明
- **長所**: 
  - 利点1
  - 利点2
- **短所/リスク**: 
  - 懸念点1
  - 懸念点2

### 案 B: [アプローチ名]
- **概要**: 簡潔な説明
- **長所**: 
  - 利点1
- **短所/リスク**: 
  - 懸念点1

### 案 C: [アプローチ名]（必要に応じて）
- **概要**: 簡潔な説明
- **長所**: 
- **短所/リスク**: 

## 選定理由
- **採用案**: 案A
- **根拠**: 
  - Next.js 15のベストプラクティスに沿っている
  - パフォーマンス/保守性のバランスが良い
  - プロジェクトルールとの整合性

## TODO / 開発メモ
- データモデル: 必要な型定義、API仕様
- UI 変更点: コンポーネント構成、ルーティング
- テスト観点: 単体/統合テストで確認すべき項目
- リスク緩和策: 想定されるエッジケースへの対応

## 参考リソース
- 関連する既存実装: `src/app/.../...`
- プロジェクトルール: `.cursor/rules/01-architecture.mdc`
```

## 注意事項
- Server Component vs Client Component の選択を明確に
- Data Cache、TanStack Query などキャッシュ戦略を考慮
- エラーハンドリング（Result型）の方針を含める
- 状態管理の適切な手段を選定

## 次のステップ
技術計画が承認されたら、`/tasks` コマンドでタスク分解に進んでください。

